import numpy as np

from sklearn.naive_bayes import MultinomialNB
import constants as const
import data_reader
import data_cleaner as dc
import model
from sklearn import svm


def main():
    print('Generate the data set...')
    filename = data_reader.generate_data_bayes(const.BIG_DATA, [const.S1, const.S4, const.S5, const.S6, const.S7])
    print('Clean the data set...')
    # X, y = dc.clean_data_bayes(filename)
    X, y = dc.clean_data_linear(filename)
    print('Train and evaluation of the model...')
    # estimator = MultinomialNB()
    estimator = svm.LinearSVC(max_iter=2000)
    accuracy, precision, recall, fscore = model.validation(estimator, X, y)
    print('Accuracy: ' + repr(accuracy))
    print('Precision: ' + repr(precision))
    print('Recall: ' + repr(recall))
    print('F1 score: ' + repr(fscore))


if __name__ == '__main__':
    main()
