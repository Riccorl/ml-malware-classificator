import numpy as np

import constants as const
import data_manager
import naive_bayes as nb


def main():
    print('Generate the data set...')
    filename = data_manager.generate_data_bayes(const.SMALL_DATA, [const.S5, const.S6, const.S7])
    print('Clean the data set...')
    df, counts = nb.clean_data(filename)
    print('Train and evaluation of the model...')
    accuracy, precision, recall, fscore = nb.validation(counts, np.array(df['label']))
    print('Accuracy: ' + repr(accuracy))
    print('Precision: ' + repr(precision))
    print('Recall: ' + repr(recall))
    print('F1 score: ' + repr(fscore))


if __name__ == '__main__':
    main()
